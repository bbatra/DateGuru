/*!CK:2631801046!*//*1418080387,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["XNTdQ"]); }

__d("ComposerXDatepickerIconReset",["CSS","cx"],function(a,b,c,d,e,f,g,h){function i(j){g.removeClass(j.element,"_4_na");g.removeClass(j.element,"_509o");}e.exports=i;},null);
__d("TimelineCapsuleUtilities",["CSS"],function(a,b,c,d,e,f,g){var h={setFirstUnit:function(i){var j=true;for(var k=0;k<i.childNodes.length;++k){var l=i.childNodes[k];if(l.id.indexOf('tl_unit_')===0)if(j){j=false;g.addClass(l,'firstUnit');}else{g.removeClass(l,'firstUnit');break;}}}};e.exports=h;},null);
__d("TimelineComposer",["Arbiter","Bootloader","ComposerXMarauderLogger","ComposerXStore","CSS","DOM","Parent","Run","TimelineCapsule","TimelineCapsuleUtilities","$","getObjectValues","goURI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t;function u(){i.logCompleted(t.id);}function v(x){if(x.hidePost){u();return;}if(x.redirect){var y=j.getAllForComposer(t.id);r(y).forEach(function(aa){if(aa.reset)aa.reset(aa);});s(x.redirect);u();return;}if(!x.streamStory){window.location.reload();return;}if(x.backdatedTime){h.loadModules(["TimelineStoryPublisher"],function(aa){aa.publish(x);});u();return;}var z=w.renderCapsuleBasedStory(t,x.streamStory);g.inform('TimelineComposer/on_after_publish',z,g.BEHAVIOR_PERSISTENT);u();}var w={init:function(x){t=q(x);var y=g.subscribe('composer/publish',function(event,z){if(z.composer_id===t.id)v(z);});n.onLeave(y.unsubscribe.bind(y));},renderCapsuleBasedStory:function(x,y){var z=m.byClass(x,'fbTimelineCapsule');if(!z)return;var aa=m.byClass(x,'fbTimelineUnit'),ba=aa.nextSibling;if(ba&&ba.getAttribute('data-spine'))aa=aa.nextSibling;l.insertAfter(aa,y);var ca=y;if(k.hasClass(y,'fbTimelineUnit'))ca=l.find(y,'div.timelineUnitContainer');h.loadModules(["Animation"],function(da){new da(ca).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(da.ease.both).go();});p.setFirstUnit(z);o.balanceCapsule(z);return y;}};e.exports=a.TimelineComposer||w;},null);
__d("TimelineComposerUtilities",["Event","Arbiter","Bootloader","CSS","DOM","DOMQuery","Parent","TimelineUnitSelector","Vector","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=86400*31,r=86400000,s={listenToSetEstimatedDate:function(t,u){return h.subscribe('ComposerXTimelineTagger/init',function(v,w){if(l.contains(t,w.datePickerElement)){s.setEstimatedDate(w.datePickerInstance,u());w.composerTimelineTagger.switchToTagger('date');}});},listenToPublish:function(t,u){if(t.root)t=t.root;return h.subscribe('composer/publish',function(event,v){if(v.composer_id===t.id)i.loadModules(["TimelineStoryPublisher"],function(w){w.publish(v);u&&u();});});},listenToAnotherComposerOpen:function(t,u){return h.subscribe('composer/mutate',function(v,w){if(w!==t)u();});},listenToCancel:function(t,u){return g.listen(t,'click',function(event){if(m.byClass(event.getTarget(),"_306"))u();});},setEstimatedDate:function(t,u){var v,w;if(u&&j.hasClass(u,'fbTimelineCapsule')){v=u.getAttribute('data-start');w=u.getAttribute('data-end');if(v&&w){var x=new Date(w*1000),y=new Date();if(x>y){t.setDate(y.getFullYear(),y.getMonth()+1,y.getDate());}else if(w-v>2*q){t.setDate(x.getFullYear());}else t.setDate(x.getFullYear(),x.getMonth()+1);}return;}var z=m.byClass(u,'fbTimelineCapsule');if(z){v=z.getAttribute('data-start');w=z.getAttribute('data-end');var aa=o.getElementPosition(u).y,ba=[w,null],ca=[v,null],da=n.getUnitsWithTime(z);for(var ea=0;ea<da.length;ea++){var fa=da[ea],ga=k.scry(fa.parentNode,'.spinePointer')[0];if(!ga)continue;var ha=o.getElementPosition(ga).y;if(ha<=aa){if(!ba[1]||ha>ba[1])ba=[fa.getAttribute('data-time'),ha];}else if(!ca[1]||ha<ca[1])ca=[fa.getAttribute('data-time'),ha];}if(ba[0]!==null&&ca[0]!==null){var ia=Math.round((parseInt(ba[0],10)+parseInt(ca[0],10))/2)*1000;ia=Math.min(new Date()-r,ia);t.setDateWithTimestamp(ia);}}}};e.exports=s;},null);
__d("TimelineContentLoader",["Arbiter","CSS","DOM","DOMScroll","Event","OnVisible","Parent","ProfileTabConst","ScrollingPager","TimelineComponentKeys","TimelineConstants","TimelineController","TimelineLegacySections","TimelineSmartInsert","UIPagelet","Vector","$","arrayContains","copyProperties","createArrayFromMixed","csx","debounce","ge","getElementText","startsWith","fbt","userAction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){var ha=false,ia,ja=null,ka={},la=[],ma={},na=[],oa={},pa={},qa={},ra={},sa=null,ta=false,ua=null;function va(eb,fb,gb,hb,ib){"use strict";this.node=eb;this.loaded=hb;this.canScrollLoad=true;this.canUnload=fb!=db.RECENT;this.scrubberKey=fb;this.historicUnitCount=ib;this._pageletLoadData=gb;this._expandPageletLoadData={};this.rightColumnFinished=false;}va.prototype.load=function(eb,fb){"use strict";if(this.loaded)return;var gb=this._pageletLoadData;g.inform(q.SECTION_LOADING,{data:gb,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var hb='ProfileTimelineSectionPagelet',ib=this.scrubberKey==db.WAY_BACK;if(ib)hb='ProfileTimelineRemainingYearsPagelet';gb.highlight_unit_data=eb;gb.parent_key=this.parentKey;gb.force_no_friend_activity=ta;h.conditionClass(this.node,'combinedSections',gb.combine_sections);h.conditionClass(this.node,'fbTimelineSectionLoading',!gb.combine_sections);this.canScrollLoad=false;var jb=null;if(fb&&!gb.combine_sections){this.node.style.minHeight=window.innerHeight+'px';jb=function(){this.node.style.minHeight='';ab(this.scrubberKey);}.bind(this);}else if(gb.combine_sections)jb=function(){ab(this.scrubberKey);db.hideSection(this.scrubberKey);}.bind(this);var kb=gb.combine_sections&&ib;qa[this.scrubberKey]=u.loadFromEndpoint(hb,kb?gb.unit_container_id+'_left':this.node.id,gb,{usePipe:true,jsNonblock:true,constHeight:true,append:kb,finallyHandler:jb});bb();};va.prototype.preload=function(){"use strict";h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var eb=i.find(this.node,'span.sectionLabel');if(eb.getAttribute('data-original-label')){i.setContent(eb,eb.getAttribute('data-original-label'));eb.removeAttribute('data-original-label');}};va.prototype.unload=function(){"use strict";if(!this.loaded||!this.canUnload)return;this.loaded=false;qa[this.scrubberKey]&&qa[this.scrubberKey].cancel();h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();};va.prototype.activateScrollLoad=function(){"use strict";this.canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');pa[this.scrubberKey]&&pa[this.scrubberKey].reset();};va.prototype.deactivateScrollLoad=function(){"use strict";if(!this.loaded){this.canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');pa[this.scrubberKey]&&pa[this.scrubberKey].remove();}};va.prototype.setExpandLoadData=function(eb){"use strict";this._expandPageletLoadData=eb;return this;};va.prototype.appendData=function(eb){"use strict";y(this._pageleLoadData,eb);return this;};va.prototype.expandSubSections=function(){"use strict";if(this.subSections.length)db.navigateToSection(this.subSections[0].scrubberKey);};va.prototype.expand=function(eb){"use strict";if(!this.loaded)return;sa.add_event('expand_'+this.scrubberKey);var fb=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(fb.firstChild,'async_saving');eb&&h.addClass(eb,'async_saving');db.navigateToSection(this.scrubberKey);i.scry(this.node,'.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;qa[this.scrubberKey]&&qa[this.scrubberKey].cancel();qa[this.scrubberKey]=u.loadFromEndpoint('ProfileTimelineSectionPagelet',fb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});};va.prototype.isPermalinkPeriod=function(){"use strict";return this._pageletLoadData.is_permalink_period;};va.prototype.shouldCombineSections=function(){"use strict";return this._pageletLoadData.combine_sections;};function wa(){if(ha)return;r.register(p.CONTENT,db);sa=ga('timeline').uai('init','scrubber',false);ha=true;}var xa=ba(function(eb,fb,gb){var hb=s.get(eb).historicUnitCount;fb-=hb;gb-=1;if(hb==-1||gb<=0||fb<0)return;var ib=db.getNextSectionKey(eb);if(ib){s.get(ib).load();xa(ib,fb,gb);}},500);function ya(eb,fb,gb,hb){var ib=db.getNextSectionKey(fb);if(ib){pa[ib]=new l(eb,za.bind(null,ib),false,gb||1000);}else if(fb!==db.WAY_BACK){hb=hb?hb:0;if(hb>80)return null;setTimeout(ya.bind(null,eb,fb,gb,hb+1),250);}}function za(eb){var fb=s.get(eb);if(fb&&fb.canScrollLoad){sa.add_event("scroll_load_"+eb);fb.load();if(ua&&!fb.shouldCombineSections())xa(eb,ua.required_units,ua.max_parallelism);}}function ab(eb){var fb=pa[eb];if(fb){fb.remove();pa[eb]=null;i.remove(fb.getElement());}}function bb(){var eb,fb,gb=false;for(var hb=0;hb<la.length;hb++){var ib=la[hb];if(!ib)continue;var jb=s.get(ib);if(jb&&(jb.canScrollLoad||jb.loaded)){if(!jb.loaded){h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}if(eb&&fb){cb(eb,fb);if(gb)eb.deactivateScrollLoad();gb=true;}eb=null;fb=null;continue;}else if(eb){fb=jb;jb.deactivateScrollLoad();}else{eb=jb;if(gb)jb.activateScrollLoad();}h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}}function cb(eb,fb){h.removeClass(fb.node,'fbTimelineTimePeriodUnexpanded');h.addClass(fb.node,'fbTimelineTimePeriodSuppressed');var gb=i.find(eb.node,'span.sectionLabel'),hb=i.find(fb.node,'span.sectionLabel');if(!hb.getAttribute('data-original-label'))hb.setAttribute('data-original-label',da(hb));if(gb.getAttribute('data-month')&&hb.getAttribute('data-month')&&gb.getAttribute('data-year')==hb.getAttribute('data-year')){i.setContent(hb,fa._("Show {month1} - {month2} {year}",[fa.param("month1",hb.getAttribute('data-month')),fa.param("month2",gb.getAttribute('data-month')),fa.param("year",gb.getAttribute('data-year'))]));}else if(gb.getAttribute('data-year')!==hb.getAttribute('data-year')){i.setContent(hb,fa._("Show {year1} - {year2}",[fa.param("year1",hb.getAttribute('data-year')),fa.param("year2",gb.getAttribute('data-year'))]));}else i.setContent(hb,fa._("Show {year}",[fa.param("year",hb.getAttribute('data-year'))]));}var db={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,FOOTER_HEIGHT:60,registerTimePeriod:function(eb,fb,gb,hb,ib,jb,kb){wa();if(x(na,fb))return;if(ma)y(gb,ma);var lb=new va(eb,fb,gb,hb,kb);if(!ib){la[jb]=fb;ka[fb]=true;}else{lb.parentKey=ib;s.get(ib).subSections=s.get(ib).subSections||[];s.get(ib).subSections[jb]=lb;}if(lb.shouldCombineSections())r.hideStickyHeaderNavSectionMenu();s.set(fb,lb);db.checkCurrentSectionChange();g.inform(q.SECTION_REGISTERED,{scrubberKey:fb,period:lb});},reset:function(){for(var eb in pa)pa[eb]&&pa[eb].remove();for(var fb in qa)qa[fb]&&qa[fb].cancel();for(var gb in ra){ra[gb].unsubscribe();delete ra[gb];}ia&&ia.unsubscribe();ia=null;s.removeAll();ja=null;ka={};la=[];ma={};na=[];oa={};pa={};qa={};sa=null;ta=false;ha=false;},checkCurrentSectionChange:function(){var eb=db.getCurrentSection(),fb=ja&&ja.scrubberKey;if(eb&&eb.scrubberKey!==fb&&!eb.isPermalinkPeriod()){ja=eb;var gb=eb.scrubberKey,hb=eb.parentKey;if(!hb){hb=gb;gb=null;}r.sectionHasChanged(hb,gb);}},setParallelLoadConfig:function(eb){ua=eb;},getCurrentSection:function(){var eb={},fb=s.getAll();for(var gb in fb){var hb=fb[gb];if(!hb.loaded||oa[hb.scrubberKey])continue;var ib=v.getElementPosition(hb.node,'viewport').y;if(hb.scrubberKey=='recent')ib--;if(ib<db.CURRENT_SECTION_OFFSET)eb[ib]=hb;}var jb=Math.max.apply(null,Object.keys(eb)),kb=jb==-Infinity;if(!kb){return eb[jb];}else if(la[0])return s.get(la[0]);return null;},capsuleForCurrentSection:function(){var eb=db.getCurrentSection();return eb&&i.scry(eb.node,'.fbTimelineCapsule')[0];},enableScrollLoad:function(eb,fb,gb,hb){eb=w(eb);var ib=m.byClass(eb,'fbTimelineSection')||eb.parentNode,jb=ib&&i.scry(ib,'.fbTimelineCapsule')[0];if(!jb)return;if(gb===null){ya(eb,fb,hb);}else r.runOnceWhenSectionFullyLoaded(ya.bind(null,eb,fb,hb),fb,gb);},loadNextSectionOnClick:function(eb,fb){eb=w(eb);k.listen(eb,'click',function(gb){gb.prevent();i.remove(eb);za(db.getNextSectionKey(fb));});},expandSectionOnClick:function(eb,fb){k.listen(eb,'click',function(gb){gb.prevent();s.get(fb).expand();});},expandSubSectionsOnClick:function(eb,fb){k.listen(eb,'click',function(gb){gb.prevent();s.get(fb).expandSubSections();});},getNextSectionKey:function(eb){for(var fb=0;fb<la.length-1;fb++)if(la[fb]==eb){while(fb<la.length-1&&!la[fb+1])fb++;return la[fb+1];}var gb=s.get(eb);if(!gb||!gb.parentKey)return;var hb=s.get(gb.parentKey);if(!hb)return;for(var ib=0;ib<hb.subSections.length-1;ib++)if(hb.subSections[ib].scrubberKey==eb)return hb.subSections[ib+1].scrubberKey;},hideSection:function(eb){var fb=s.get(eb);fb&&h.hide(i.find(fb.node,'.fbTimelineSection'));var gb=r.getCurrentScrubber();if(gb){var hb=null;if(!ka[eb]){var ib=fb.parentKey;hb=r.getCurrentScrubber().getSubnav(ib,eb);}else hb=r.getCurrentScrubber().getNav(eb);hb&&h.hide(hb);}var jb=r.getCurrentStickyHeaderNav();jb&&jb.removeTimePeriod(eb);oa[eb]=true;},loadSectionOnClick:function(eb,fb){k.listen(eb,'click',function(gb){gb.prevent();s.get(fb).load();});},removeSection:function(eb){for(var fb in la)if(la[fb]==eb){la[fb]=null;break;}s.remove(eb);delete ka[eb];if(eb in pa){pa[eb].remove();delete pa[eb];}var gb=r.getCurrentStickyHeaderNav();gb&&gb.removeTimePeriod(eb);na.push(eb);},removeSectionParent:function(eb){i.remove(w(eb).parentNode);},navigateToSection:function(eb,fb,gb){sa.add_event("nav_"+eb);fb=!!fb;var hb=eb,ib=s.get(eb);if(!ib)return;if(!ib.loaded){t.enable();i.scry(w('timeline_tab_content'),'.fbTimelineShowOlderSections').forEach(i.remove);}if(!ka[eb]){if(!ib.loaded)ib.node.style.minHeight=v.getViewportDimensions().y+'px';var jb=g.subscribe(q.SECTION_FULLY_LOADED,function(qb,rb){if(rb.scrubberKey===eb){ib.node.style.minHeight='';jb.unsubscribe();}});hb=ib.parentKey;var kb=s.get(hb).node;if(!h.hasClass(kb,'fbTimelineSectionExpanded')){j.scrollTo(kb,0);h.addClass(kb,'fbTimelineSectionExpanded');i.scry(kb,'.fbTimelineCapsule').forEach(i.remove);i.scry(kb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(kb,'div.fbTimelineContentHeader').forEach(i.remove);i.scry(kb,"._5vf").forEach(function(qb){if(!qb.getAttribute('data-subsection'))i.remove(qb);});}var lb=db.getNextSectionKey(hb);if(lb&&pa[lb])pa[lb].setBuffer(0);}for(var mb=0;mb<la.length;mb++){var nb=la[mb];if(!nb)continue;if(nb==hb)break;s.get(nb).deactivateScrollLoad();i.scry(w('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(qb){var rb=o.getInstance(qb.id);rb&&rb.removeOnVisible();});}ib.load(gb,true);bb();var ob=v.getScrollPosition().x,pb=v.getElementPosition(ib.node).y;if(!fb)j.scrollTo(new v(ob,pb-q.SCROLL_TO_OFFSET,'document'),true,false,false,0,function(){var qb=v.getElementPosition(ib.node).y;j.scrollTo(new v(ob,qb-q.SCROLL_TO_OFFSET,'document'),false);var rb=i.scry(ib.node,'h3.uiHeaderTitle')[0];if(rb){rb.tabIndex=0;rb.focus();}});},appendContentAfterLoad:function(eb,fb,gb){r.runOnceWhenSectionFullyLoaded(i.appendContent.bind(null,w(eb),fb),gb,'0');},markSectionAsLoaded:function(eb,fb,gb){r.runOnceWhenSectionFullyLoaded(function(){ca(eb)&&h.removeClass(w(eb).parentNode,'fbTimelineSectionLoading');},fb,gb);},suppressSectionsAbove:function(eb){var fb,gb;for(var hb=0;hb<la.length;hb++){var ib=la[hb];if(!ib)continue;fb=s.get(ib).node;gb=null;if(z(eb.parentNode.children).indexOf(eb)<=z(fb.parentNode.children).indexOf(fb)){gb=ib;break;}s.get(ib).deactivateScrollLoad();}if(gb)db.navigateToSection(gb,true);},forceNoFriendActivity:function(){ta=true;},removeDupes:function(eb){var fb=ca(eb);if(!fb)return;var gb=i.scry(fb,'li.fbTimelineUnit'),hb={};for(var ib=0;ib<gb.length;ib++){var jb=gb[ib];if(jb.id&&ea(jb.id,'tl_unit_')){var kb=jb.id.substring(8,jb.id.length),lb=i.scry(jb,'div.timelineUnitContainer');if(lb.length>0)kb=kb+lb[0].getAttribute('data-time');if(hb.hasOwnProperty(kb)){jb.id='dupe_unit_'+Math.random();jb.className="hidden_elem";}else hb[kb]=1;}}},removeLoadingState:function(eb){ca(eb)&&h.removeClass(w(eb),'fbTimelineSectionLoading');},setExpandLoadDataForSection:function(eb,fb){var gb=s.get(eb);gb&&gb.setExpandLoadData(fb);},appendSectionDataForAllSections:function(eb){ma=eb;for(var fb=0;fb<la.length-1;fb++){var gb=la[fb];if(!gb)continue;var hb=s.get(gb);hb&&hb.appendData(eb);}},updatePagerAfterLoad:function(eb,fb,gb,hb,ib){var jb=o.getInstance(eb.firstChild.id);if(!jb){ra[eb.firstChild.id]=g.subscribe(o.REGISTERED,function(kb,lb){ra[eb.firstChild.id].unsubscribe();delete ra[eb.firstChild.id];if(lb.id===eb.firstChild.id)db.updatePagerAfterLoad(eb,fb,gb,hb,ib);});return;}r.runOnceWhenSectionFullyLoaded(function(){h.removeClass(eb,'fbTimelineHiddenPager');jb.checkBuffer();},gb,hb);if(ib)r.runOnceWhenSectionFullyLoaded(r.adjustScrollingPagerBuffer.bind(null,eb.firstChild.id,fb),gb,hb);},repositionDialog:function(eb){g.subscribe(q.SECTION_LOADED,function(){eb.updatePosition();});},rightColumnFinished:function(eb){var fb=s.get(eb);fb.rightColumnFinished=true;},addUnrankedUnits:function(eb){var fb=w(eb),gb=i.scry(fb,'li.fbTimelineUnit');for(var hb=gb.length-1;hb>=0;hb--){var ib=gb[hb];i.insertAfter(fb,ib);h.addClass(i.find(ib,'div.timelineUnitContainer'),'fbTimelineHighlightUnit');}i.remove(fb);},addUnrankedStories:function(eb){var fb=w(eb),gb=i.scry(fb,"._5pat");for(var hb=gb.length-1;hb>=0;hb--){var ib=gb[hb];i.insertAfter(fb,ib);}i.remove(fb);}};e.exports=db;},null);
__d("TimelineLogging",["TimelineComponentKeys","TimelineController","reportData"],function(a,b,c,d,e,f,g,h,i){var j=false,k=0,l=null,m=null,n={init:function(o){if(j)return;k=o;h.register(g.LOGGING,this);},reset:function(){j=false;k=0;l=null;},log:function(o,p){p.profile_id=k;i(o,{gt:p});},logSectionChange:function(o,p){var q={timeline_section_change:1,key:o};if(l&&o==l){q.timeline_scrubber=1;l=null;}if(m&&o==m){q.sticky_header_nav=1;m=null;}n.log('timeline',q);},logScrubberClick:function(o){l=o;},logStickyHeaderNavClick:function(o){m=o;}};e.exports=n;},null);
__d("TimelineSpinelessComposer",["Arbiter","Bootloader","ComposerXMarauderLogger","Run","TimelineComposer","TimelineComposerUtilities"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m;function n(){i.logCompleted(m.id);}function o(q){if(q.hidePost){n();return;}if(!q.streamStory){window.location.reload();return;}if(q.backdatedTime){h.loadModules(["TimelineStoryPublisher"],function(r){r.publish(q);});n();return;}k.renderCapsuleBasedStory(m,q.streamStory);n();}var p={init:function(q){m=q;var r=g.subscribe('composer/publish',function(event,s){if(s.composer_id===m.id)o(s);});j.onLeave(r.unsubscribe.bind(r));}};e.exports=p;},null);
__d("TimelineStickyRightColumn",["Arbiter","CSS","DOMQuery","Event","PhotoSnowlift","Run","Style","TimelineContentLoader","Vector","csx","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=100,s=15,t=15,u=35,v=false,w=null,x=null,y,z,aa,ba,ca,da,ea,fa;function ga(){if(k.getInstance().isOpen)return;y=n.getCurrentSection();if(!y||!y.rightColumnFinished)return;var oa=i.scry(y.node,"._3rbf")[0],pa=i.scry(y.node,"._3rbh")[0];z=oa?oa.offsetHeight:0;aa=pa?pa.offsetHeight:0;ba=o.getViewportDimensions().y;ea=oa?o.getElementPosition(oa).y:0;fa=document.body.clientWidth<document.body.scrollWidth;}function ha(){if(!y||k.getInstance().isOpen)return;if(x&&x!==y){var oa=i.scry(x.node,"._3rbh")[0];if(oa)ja(oa,'','','');}var pa=i.scry(y.node,"._3rbh")[0];if(!pa)return;if(fa){ja(pa,'','','');return;}if(!y||!y.rightColumnFinished)return;ia(y);x=h.hasClass(pa,'fixed_always')?y:null;}function ia(oa){if(aa>=z||z<=ba)return;da=ca;ca=o.getScrollPosition().y;var pa,qa=i.scry(oa.node,"._3rbh")[0];if(!qa)return;if(ca<=ea-ka()){ja(qa,'','','');return;}if(z+ea<=ca+Math.min(aa+ka(),ba-t-u)){ja(qa,'absolute','',t+'px');return;}if(aa>ba-t-ka()){if(ca<da){var ra=false;if(qa.style.position==='absolute')if(qa.style.top!==''&&ca+ka()-ea<=parseInt(qa.style.top,10)){ra=true;}else if(qa.style.bottom!==''&&ca<=(ea+z-ka())-aa)ra=true;if(ra){ja(qa,'fixed',ka()+'px','');return;}else if(qa.style.position==='absolute'&&qa.style.top){return;}else if(h.hasClass(qa,'fixed_always')){if(parseInt(qa.style.top,10)>=ka())return;pa=ca-ea-(aa-(ba-u));if(da)pa+=da-ca;ja(qa,'absolute',pa+'px','');return;}}else{var sa=false;if(qa.style.position==='absolute'||(qa.style.position===''&&!h.hasClass(qa,'fixed_always'))){pa=qa.style.top?parseInt(qa.style.top,10):0;if(ca+ba>=ea+pa+aa+u)sa=true;}if(sa){pa=ba-aa-t-u;ja(qa,'fixed',pa+'px','');return;}else if(ca==da){return;}else if(h.hasClass(qa,'fixed_always')){if(parseInt(qa.style.top,10)>=ka()){pa=ca-ea+ka();if(da)pa+=da-ca;ja(qa,'absolute',pa+'px','');return;}}else if(qa.style.position==='absolute')return;}}else ja(qa,'fixed',ka()+'px','');}function ja(oa,pa,qa,ra){m.set(oa,'bottom',ra);if(pa==='fixed'){h.addClass(oa,'fixed_always');m.set(oa,'position','');}else{h.removeClass(oa,'fixed_always');m.set(oa,'position',pa);}m.set(oa,'top',qa);g.inform('reflow');}function ka(){return h.hasClass(document.documentElement,'tinyViewport')?s:r;}function la(){q(ga,ha);}function ma(){v=false;x=null;while(w.length)w.pop().remove();w=null;}var na={init:function(){if(v)return;v=true;w=[j.listen(window,'scroll',la),j.listen(window,'resize',la)];l.onLeave(ma);},adjust:function(){if(v){ga();ha();}}};e.exports=na;},null);