/*!CK:2238789506!*//*1418086786,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["ltbXi"]); }

__d("TimelineScrubber",["CSS","DOM","Event","Focus","Keys","Parent","ProfileTabUtils","TimelineComponentKeys","TimelineController","Vector","copyProperties","cx","getElementText"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t="_3rrn";function u(v){"use strict";this.$TimelineScrubber0=v;this.$TimelineScrubber1={};this.$TimelineScrubber2={};this.$TimelineScrubber3={};this.$TimelineScrubber4={};var w=v.childNodes;this.$TimelineScrubber5=w[0];for(var x=0;x<w.length;x++){var y=w[x].getAttribute('data-key');this.$TimelineScrubber1[y]=w[x];var z=h.scry(w[x],'ul');this.$TimelineScrubber2[y]={};if(z.length){var aa=z[0].childNodes;for(var ba=0;ba<aa.length;ba++)this.$TimelineScrubber2[y][aa[ba].getAttribute('data-key')]=aa[ba];}var ca=w[x].getAttribute('data-rollup');if(ca){this.$TimelineScrubber3[ca]=this.$TimelineScrubber3[ca]||[];this.$TimelineScrubber3[ca].push(w[x]);}}this.$TimelineScrubber6=i.listen(this.$TimelineScrubber0,'click',this.$TimelineScrubber7.bind(this));this.$TimelineScrubber8=i.listen(this.$TimelineScrubber0,'keydown',this.$TimelineScrubber9.bind(this));this.$TimelineScrubbera=h.scry(this.$TimelineScrubber0,'a')[0];g.show(this.$TimelineScrubber0);var da=p.getViewportDimensions().y-this.SCRUBBER_NO_ADS_VERTICAL_BUFFER,ea=this.getHeight();if(ea>da)this.fold(ea-da);o.register(n.SCRUBBER,this);o.scrubberHasLoaded(this);}u.prototype.reset=function(){"use strict";this.$TimelineScrubber6&&this.$TimelineScrubber6.remove();this.$TimelineScrubber8&&this.$TimelineScrubber8.remove();this.$TimelineScrubber0=null;this.$TimelineScrubber1={};this.$TimelineScrubber2={};this.$TimelineScrubber3={};this.$TimelineScrubber4={};};u.prototype.getRoot=function(){"use strict";return this.$TimelineScrubber0;};u.prototype.getNav=function(v){"use strict";return this.$TimelineScrubber1[v];};u.prototype.getSubnav=function(v,w){"use strict";var x=this.$TimelineScrubber2[v];return x&&x[w];};u.prototype.getHeight=function(){"use strict";return this.$TimelineScrubber0.offsetHeight;};u.prototype.getLabelForNav=function(v){"use strict";var w=this.getNav(v);return w&&s(h.scry(w,'a')[0]);};u.prototype.getLabelForSubnav=function(v,w){"use strict";var x=this.getSubnav(v,w);return x&&s(h.scry(x,'a')[0]);};u.prototype.fold=function(v){"use strict";return this.$TimelineScrubberb(v,true);};u.prototype.unfold=function(v){"use strict";return this.$TimelineScrubberb(v,false);};u.prototype.handleTabChange=function(v){"use strict";g.conditionShow(this.$TimelineScrubber0,m.tabHasScrubber(v));};u.prototype.getOffset=function(){"use strict";return this.OFFSET+(g.hasClass(document.body,'hasVoiceBar')?26:0)+(g.hasClass('rightColContent','pagesTimelineRightColumn')?48:0);};u.prototype.updateSection=function(v,w){"use strict";if(!this.$TimelineScrubber1[v])return;var x=this.$TimelineScrubber1[v].getAttribute('data-rollup');if(this.$TimelineScrubberc&&this.$TimelineScrubberc!=x){g.removeClass(this.$TimelineScrubberc,t);g.removeClass(h.scry(this.$TimelineScrubberc,'ul')[0],'loaded');delete this.$TimelineScrubberc;}if(x&&this.$TimelineScrubber4[x]){var y=this.$TimelineScrubber4[x];if(y.getAttribute('data-rollup')){this.$TimelineScrubberc=y;g.addClass(this.$TimelineScrubberc,t);g.addClass(h.scry(this.$TimelineScrubberc,'ul')[0],'loaded');}}this.$TimelineScrubber5&&g.removeClass(this.$TimelineScrubber5,t);this.$TimelineScrubberd&&g.removeClass(this.$TimelineScrubberd,t);this.$TimelineScrubber5=null;this.$TimelineScrubberd=null;if(this.$TimelineScrubber1[v]){this.$TimelineScrubber5=this.$TimelineScrubber1[v];g.addClass(this.$TimelineScrubber5,t);if(this.decadesAreSelectable&&this.$TimelineScrubber1[w]){this.$TimelineScrubberd=this.$TimelineScrubber1[w];g.addClass(this.$TimelineScrubberd,t);}else if(w&&this.$TimelineScrubber2[v][w]){this.$TimelineScrubberd=this.$TimelineScrubber2[v][w];g.addClass(this.$TimelineScrubberd,t);}}};u.prototype.$TimelineScrubbere=function(v){"use strict";var w=this.$TimelineScrubber5,x=w&&w.getAttribute('data-rollup'),y=this.KEY_HEIGHT*(this.$TimelineScrubber3[v].length-1);if(v==x){y+=this.SUBKEY_HEIGHT*h.scry(w,'li').length;y-=this.SUBKEY_HEIGHT*(this.$TimelineScrubber3[v].length-1);}return y;};u.prototype.$TimelineScrubberb=function(v,w){"use strict";var x=v,y=Object.keys(this.$TimelineScrubber3);while(v>0&&y.length){var z=y[w?'pop':'shift']();if(!w==!this.$TimelineScrubber4[z])continue;var aa=this.$TimelineScrubbere(z);if(aa<=0)continue;if(!w&&aa>v)break;if(w){this.$TimelineScrubberf(z);}else this.$TimelineScrubberg(z);v-=aa;}return x-v;};u.prototype.$TimelineScrubberf=function(v){"use strict";var w=this.$TimelineScrubber3[v];if(!w||w.length<2||this.$TimelineScrubber4[v])return;var x=w[0].previousSibling,y=w[0],z=h.create('a',{href:y.firstChild.href,rel:'ignore',tabindex:'-1'},[v]),aa=h.create('ul',{className:'clearfix'});for(var ba=0;ba<w.length;ba++)aa.appendChild(w[ba]);var ca=h.create('li',null,[z,aa]);if(this.decadesAreSelectable){var da=w[w.length-1],ea=y.getAttribute('data-key')+da.getAttribute('data-key');ca.setAttribute('data-start',da.getAttribute('data-start'));ca.setAttribute('data-end',y.getAttribute('data-end'));ca.setAttribute('data-key',ea);this.$TimelineScrubber1[ea]=ca;}else ca.setAttribute('data-key',y.getAttribute('data-key'));ca.setAttribute('data-rollup',v);if(x){h.insertAfter(x,ca);}else h.prependContent(this.$TimelineScrubber0,ca);this.$TimelineScrubber4[v]=ca;this.$TimelineScrubberh();this.$TimelineScrubberi();};u.prototype.$TimelineScrubberg=function(v){"use strict";if(!this.$TimelineScrubber4[v])return;var w=this.$TimelineScrubber4[v],x=h.scry(w,'ul')[0],y=document.createDocumentFragment();while(x.childNodes.length)y.appendChild(x.firstChild);h.replace(w,y);this.$TimelineScrubber4[v]=false;this.$TimelineScrubberh();};u.prototype.$TimelineScrubberh=function(){"use strict";if(this.$TimelineScrubber5){var v=this.$TimelineScrubberd&&this.$TimelineScrubberd.getAttribute('data-key');this.updateSection(this.$TimelineScrubber5.getAttribute('data-key'),v);}};u.prototype.$TimelineScrubber7=function(event){"use strict";var v=event.getModifiers();if(event.isMiddleClick()||v.access||v.meta)return true;var w=l.byTag(event.getTarget(),'a'),x=w&&l.byAttribute(w,'data-key');if(x){o.scrubberWasClicked(x.getAttribute('data-key'));o.navigateToSection(x.getAttribute('data-key'));return event.prevent();}};u.prototype.$TimelineScrubberi=function(){"use strict";while(!(this.$TimelineScrubbera.offsetHeight||this.$TimelineScrubbera.offsetWidth)){this.$TimelineScrubbera.tabIndex=-1;var v=l.byTag(l.byTag(this.$TimelineScrubbera,'li'),'li');this.$TimelineScrubbera=h.scry(v,'a')[0];this.$TimelineScrubbera.tabIndex=0;}};u.prototype.$TimelineScrubber9=function(event){"use strict";if(event.getModifiers().any)return;var v=i.getKeyCode(event);if(v===k.UP||v===k.DOWN){var w=h.scry(this.$TimelineScrubber0,'a').filter(function(z){return z.offsetHeight||z.offsetWidth;}),x=w.indexOf(this.$TimelineScrubbera);if(x!=-1){var y=w[x+(v===k.UP?-1:1)];if(y){y.tabindex=0;j.set(y);this.$TimelineScrubbera.tabindex=-1;this.$TimelineScrubbera=y;event.prevent();}}}};q(u.prototype,{KEY_HEIGHT:23,SUBKEY_HEIGHT:16,OFFSET:38,SCRUBBER_NO_ADS_VERTICAL_BUFFER:125});e.exports=u;},null);
__d("TimelineMainScrubber",["Arbiter","CSS","DOMQuery","TimelineConstants","TimelineController","TimelineScrubber"],function(a,b,c,d,e,f,g,h,i,j,k,l){for(var m in l)if(l.hasOwnProperty(m))o[m]=l[m];var n=l===null?null:l.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=l;function o(p){"use strict";l.call(this,p);this.$TimelineMainScrubber0=g.subscribe(j.SECTION_LOADED,function(q,r){var s=this.getNav(r.key),t=s&&i.scry(s,'ul')[0];if(t){h.addClass(t,'loaded');k.scrubberHasChangedState();if(r.hideSubSections)h.hide(t);}}.bind(this));}o.prototype.reset=function(){"use strict";n.reset.call(this);this.$TimelineMainScrubber0&&this.$TimelineMainScrubber0.unsubscribe();};e.exports=o;},null);